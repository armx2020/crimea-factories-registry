# Реестр бетонных заводов Крыма

## Обзор проекта
Веб-приложение для хранения и отображения информации о бетонных заводах Крыма. Приложение позволяет администратору добавлять заводы с подробной информацией и фотографиями, а также отображать их в виде списка карточек и на интерактивной карте.

## Основные функции
- **Управление заводами**: Добавление, редактирование и удаление информации о заводах (только администратор)
- **Список заводов**: Отображение всех заводов в виде строчных карточек
- **Интерактивная карта**: Визуализация расположения заводов на карте Крыма с маркерами
- **Фильтрация**: Поиск заводов по городу и фильтрация по мощности
- **Загрузка фотографий**: До 3 фотографий на каждый завод через object storage
- **Вставка из буфера**: Поддержка вставки фото через Ctrl+V

## Технологический стек

### Frontend
- React с TypeScript
- Wouter для роутинга
- TanStack Query для работы с данными
- Shadcn UI компоненты
- Tailwind CSS для стилизации
- Leaflet для интерактивной карты
- React Hook Form с Zod валидацией

### Backend
- Express.js
- PostgreSQL с Drizzle ORM для постоянного хранения данных
- Replit Object Storage для фотографий
- Presigned URLs для безопасной загрузки файлов

## Структура данных

### Network (Сеть заводов)
- `id`: Уникальный идентификатор
- `name`: Название сети
- `description`: Описание (опционально)

### Factory (Завод)
- `id`: Уникальный идентификатор
- `name`: Название завода
- `city`: Город
- `model`: Модель завода
- `address`: Адрес
- `capacity`: Мощность (м³/ч)
- `yearlyOutput`: Годовой выпуск (м³/год)
- `description`: Описание
- `website`: Сайт (опционально)
- `ranking`: Место в рейтинге (опционально)
- `networkId`: ID сети заводов (опционально)
- `latitude`: Широта (опционально)
- `longitude`: Долгота (опционально)
- `photo1`, `photo2`, `photo3`: Пути к фотографиям (опционально)

## API Endpoints

### Заводы
- `GET /api/factories` - Получить список всех заводов
- `GET /api/factories/:id` - Получить завод по ID
- `POST /api/factories` - Создать новый завод
- `PUT /api/factories/:id` - Обновить завод
- `DELETE /api/factories/:id` - Удалить завод

### Сети заводов
- `GET /api/networks` - Получить список всех сетей
- `GET /api/networks/:id` - Получить сеть по ID
- `POST /api/networks` - Создать новую сеть
- `PUT /api/networks/:id` - Обновить сеть
- `DELETE /api/networks/:id` - Удалить сеть

### Object Storage
- `POST /api/objects/upload` - Получить presigned URL для загрузки
- `GET /objects/:objectPath` - Скачать файл из storage

## Компоненты

### Основные страницы
- `Home.tsx` - Главная страница с фильтрами, списком заводов и картой
- `Networks.tsx` - Страница управления сетями заводов

### UI Компоненты
- `FactoryCard.tsx` - Карточка завода с информацией, фотографиями и кнопкой поиска в Яндексе
- `FactoryForm.tsx` - Форма добавления/редактирования завода с выбором сети
- `FactoryFilters.tsx` - Фильтры с чекбоксами городов (показывает количество заводов) и слайдером мощности
- `FactoryMap.tsx` - Интерактивная карта с маркерами заводов
- `PhotoUploader.tsx` - Компонент загрузки фотографий
- `LocationPicker.tsx` - Интерактивная карта для выбора местоположения
- `EmptyState.tsx` - Состояние при отсутствии данных

## Design Guidelines
- Тёмная тема как основная
- Material Design / Modern Dashboard стиль
- Цветовая схема: синий акцент, нейтральные фоны
- Русский язык интерфейса
- Адаптивный дизайн для мобильных устройств

## Недавние изменения
- **16.10.2025**: Создана базовая структура проекта
- **16.10.2025**: Реализована схема данных и storage
- **16.10.2025**: Разработаны все React компоненты
- **16.10.2025**: Настроен object storage для фотографий
- **16.10.2025**: Исправлена проблема с импортом Uppy CSS, создан PhotoUploader
- **16.10.2025**: Исправлена система путей к фотографиям (uploadURL + filePath)
- **16.10.2025**: Добавлена PostgreSQL база данных с Drizzle ORM для постоянного хранения
- **16.10.2025**: Изменен дизайн карточек на строчный вид
- **16.10.2025**: Карточки стали кликабельными - клик открывает форму редактирования
- **16.10.2025**: Добавлена возможность вставки фото через Ctrl+V
- **16.10.2025**: Поле город стало выбираемым из списка
- **16.10.2025**: Добавлены координаты всех городов Крыма, заводы показываются на карте по координатам города если собственные не указаны
- **16.10.2025**: Добавлена сводка: отображение общего количества заводов и суммарной мощности
- **16.10.2025**: Добавлен Севастополь в список городов (теперь 17 городов)
- **16.10.2025**: Реализовано автозаполнение адресов при вводе через OpenStreetMap API с автоматическим заполнением координат
- **16.10.2025**: Добавлены поля "Сайт" и "Место в рейтинге", рейтинг отображается в правой части карточки
- **16.10.2025**: Реализована сортировка по умолчанию по месту в рейтинге (заводы без рейтинга показываются внизу)
- **16.10.2025**: Добавлена возможность указать местоположение завода прямо на карте в форме (клик на карте)
- **16.10.2025**: Добавлена кнопка открытия местоположения на Яндекс.Картах в спутниковом режиме из формы редактирования
- **16.10.2025**: Создан справочник сетей заводов с таблицей networks и полем networkId в factories
- **16.10.2025**: Добавлена страница "Сети" для управления сетями заводов (создание, редактирование, удаление)
- **16.10.2025**: Добавлена навигация между страницами "Заводы" и "Сети"
- **16.10.2025**: Фильтр городов заменен на список с чекбоксами, показывающими количество заводов в каждом городе
- **16.10.2025**: Добавлена кнопка "Поиск в Яндексе" в каждую карточку завода (открывает Яндекс с запросом "название + город + сайт")

## Текущее состояние
✅ Схема данных реализована
✅ PostgreSQL база данных подключена и работает
✅ API endpoints работают
✅ Frontend компоненты готовы
✅ Object storage настроен
✅ Система загрузки фотографий работает
✅ Приложение полностью функционально

## Известные проблемы
⚠️ SelectItem warning в консоли (не критично, не влияет на работу)
